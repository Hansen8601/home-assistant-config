# Home assistant configuration file

# Used to switch between development & production system
homeassistant: !include homeassistant.yaml

auth:

frontend:
  javascript_version: latest

http:
  api_password: !secret api_password
  ip_ban_enabled: True
  login_attempts_threshold: 5

# Recorder
recorder:
  purge_interval: 1
  purge_keep_days: 7
  exclude:
    entities:
      - input_boolean.set_mode_sleeping
      - input_boolean.set_mode_home
      - input_boolean.set_mode_away
      - input_number.denon_deck_volume 
      - input_number.denon_volume
      - input_select.living_room_remote
      - binary_sensor.main_floor_occupancy
      - sensor.average_load_1m
      - sensor.average_load_5m
      - sensor.dark_sky_wind_bearing
      - sensor.dark_sky_wind_speed
      - sensor.dark_sky_temperature
      - automation.denon_set_volume
      - script.denon_deck_volume_down
      - script.denon_deck_volume_up
      - script.denon_deck_volume_set
    domains:
      - weather
      - sun
      - script
      - media_player
      - remote
      - group
      - timer


# View all events in a logbook
logbook:
  exclude:
    entities:
      - automation.denon_slider_volume_set
      - automation.denon_volume_set
      - automation.denon_deck_volume_set
      - input_boolean.set_mode_home
      - input_boolean.set_mode_sleeping
      - input_boolean.set_mode_away
      - input_boolean.nikki_homekit_present
      - input_boolean.phil_homekit_present
        #- binary_sensor.stairs_motion


# Enables support for tracking state changes over time.
history:
  exclude:
    domains:
      - automation
      - weblink
      - updater


# Logger settings
logger:
  default: warn


influxdb:
  host: 192.168.1.22
  exclude:
    domains:
      - script
      - media_player
      - remote
      - group
      - timer

alexa:

ios:

intent_script:
  ActivateSceneIntent:
    action:
      service: scene.turn_on
      data_template:
        entity_id: scene.{{ Scene | replace(" ", "_") }}
    speech:  
      type: plain  
      text: !include alexa_confirm.yaml

lutron_caseta:
  host: 192.168.1.85
  keyfile: caseta.key
  certfile: caseta.crt
  ca_certs: caseta-bridge.crt

# Track the sun
sun:
  elevation: 278


# Allows you to issue voice commands from the frontend
#conversation:


# Checks for available updates
updater:
  card_urls:
    - https://raw.githubusercontent.com/kalkih/mini-media-player/master/tracker.json

# Discover some devices automatically
discovery:


# Show configuration panel
config:


# Homekit integration
homekit:
  filter:
    include_entities:
      - cover.garage_left
      - cover.garage_right
      - input_boolean.phil_homekit_present
      - input_boolean.nikki_homekit_present
      - input_boolean.set_mode_away 
      - input_boolean.set_mode_home 
      - input_boolean.set_mode_sleeping 

# Used for camera display
ffmpeg:
  ffmpeg_bin: /usr/bin/ffmpeg


camera:
  - platform: amcrest
#  - platform: ffmpeg
#    input: !secret camera_front_url1
#    name: 'Front Door 2'

  - platform: xeoma
    host: http://192.168.1.22:10090
    cameras:
      - image_name: porch
      - image_name: driveway
amcrest:
  - host: !secret camera_front_ip
    port: 80
    name: 'Front Door'
    username: !secret amcrestuser
    password: !secret amcrestpwd
    resolution: high
    stream_source: rtsp
    #sensors:
    #  - motion_detector
    #  - sdcard
  - host: !secret camera_driveway_ip
    port: 80
    name: 'Driveway'
    username: !secret amcrestuser
    password: !secret amcrestpwd
    resolution: high
    stream_source: rtsp
#    sensors:
#      - motion_detector
#      - sdcard


#device_tracker:
#  platform: mqtt
#  devices:
#    Phil_SmartThings: smartthings/Phil Hansen's iPhone/presence
#    Nikki_SmartThings: smartthings/Nikki's iPhone/presence


#mqtt broker
mqtt:
  broker: !secret mqtt_broker
  port: 1883
  keepalive: 60


twilio:
  account_sid: !secret twillo_sid 
  auth_token: !secret twillo_token


notify:
  - name: twilio_sms
    platform: twilio_sms
    from_number: !secret twillo_number


media_player:
  - platform: denonavr
    host: !secret dennon_ip
    name: Denon AVRX3000
    #  - platform: plex
    #  - platform: samsungtv
    #host: 192.168.1.40
    #port: 8001

ecobee:
  api_key: !secret ecobee_api_key


apple_tv:
  - host: 192.168.1.126
    login_id: !secret apple_tv_login_id
    name: "Apple TV Exercise"
    start_off: true
  - host: 192.168.1.86
    login_id: !secret apple_tv_login_id
    name: "Apple TV Upstairs"
    start_off: true
  - host: 192.168.1.109
    login_id: !secret apple_tv_login_id
    name: "Apple TV Basement"
    start_off: true


remote:
  - platform: harmony
    name: living_room
    host: !secret harmony_ip


rest_command:
  denon_deck_volume_set:
    url: !secret denon_url
    method: post
    payload: 'cmd0=PutMasterVolumeSet%2F{{((states.input_number.denon_deck_volume.state  | float)) - 80 }}&ZoneName=ZONE2'
  denon_deck_volume_up:
    url: !secret denon_url
    method: post
    payload: 'cmd0=PutMasterVolumeBtn%2F%3C&ZoneName=ZONE2'
  denon_deck_volume_down:
    url: !secret denon_url
    method: post
    payload: 'cmd0=PutMasterVolumeBtn%2F%3E&ZoneName=ZONE2'
  denon_deck_volume_50:
    url: !secret denon_url
    method: post
    payload: 'cmd0=PutMasterVolumeSet%2F-30&ZoneName=ZONE2'
  denon_deck_volume_55:
    url: !secret denon_url
    method: post
    payload: 'cmd0=PutMasterVolumeSet%2F-25&ZoneName=ZONE2'
  denon_deck_volume_60:
    url: !secret denon_url
    method: post
    payload: 'cmd0=PutMasterVolumeSet%2F-20&ZoneName=ZONE2'


###################
#                 #
# Binary Sensor   #
#                 #
###################

binary_sensor:
  - platform: template
    sensors:
      indoor_lights_auto_on:
        friendly_name: 'Indoor Lights Auto On'
        value_template: >-
          {%- if is_state("input_select.automation_mode","Home") -%}
            {%- if (as_timestamp(now()) - (as_timestamp(states.binary_sensor.indoor_lights_auto_on.last_changed) | int) > 900 or
                    as_timestamp(now()) - (as_timestamp(states.input_select.automation_mode.last_changed) | int) < 900 or
                    as_timestamp(now()) - (as_timestamp(states.input_number.lux_setpoint.last_changed) | int) < 10) -%}
              {%- if ((states.sun.sun.attributes.elevation | int) < 10 ) -%}
                True
              {%- elif ((states.sensor.dark_sky_cloud_coverage_stats_mean.state | int) > 85) -%}
                True
              {%- elif ((states.sensor.avg_lux_stats_mean.attributes["max_value"] | int) < (states.input_number.lux_setpoint.state | int)
                         and (states.sensor.avg_lux_stats_mean.attributes["max_value"] | int) != 'unknown'
                         and ((states.sensor.kitchen_multisensor_lux | int) < 12 or (as_timestamp(now()) |int) - (as_timestamp(states.sensor.kitchen_multisensor_lux.last_changed) | int) > 3600))-%}
                 True
              {%- else -%}
                 False
              {%- endif -%}
            {%- else -%}
              {%- if is_state("binary_sensor.indoor_lights_auto_on","off") -%}False{%- else -%}True{%- endif -%}
            {%- endif -%}
          {%- else -%}
            False
          {%- endif -%}

  - platform: template
    sensors:
      fireplace_off_sensor:
        friendly_name: "Fireplace Off Sensor"
        value_template: >-
          {%- if is_state("switch.fireplace","on") and
               (states.sensor.living_room_temperature.state >=  states.input_number.fireplace_high_setpoint.state or
               states.sensor.main_floor_temperature.state  >=  states.input_number.fireplace_high_setpoint.state) -%}
            True
          {%- else -%}
            False 
          {%- endif -%}

  - platform: mqtt
    state_topic: 'smartthings/Basement Motion Sensor/motion'
    name: 'stairs_motion'
    payload_on: 'active'
    payload_off: 'inactive'
    retain: true


###################
#                 #
# Cover           #
#                 #
###################

cover:
- platform: mqtt
  state_topic: "esp8266/garageIO/switch1"
  command_topic: "esp8266/garageIO/switch1/set"
  #availability_topic: "rpi/garage/status"
  #payload_available: "running"
  #payload_not_available: "stopped"
  name: "garage right"
  device_class: "garage"
  qos: 0 #Must be zero to work correctly
  retain: false 
  payload_open: "open"
  payload_close: "close"
  state_open: "open"
  state_closed: "closed"
  #optimistic: false

- platform: mqtt
  state_topic: "esp8266/garageIO/switch2"
  command_topic: "esp8266/garageIO/switch2/set"
  #availability_topic: "rpi/garage/status"
  #payload_available: "running"
  #payload_not_available: "stopped"
  name: "garage left"
  device_class: "garage"
  qos: 0 #must be zero to work correctly.
  retain: false
  payload_open: "open"
  payload_close: "close"
  state_open: "open"
  state_closed: "closed"
  #optimistic: false


###################
#                 #
# Fan             #
#                 #
###################

fan:
  - platform: mqtt
    name: "Living Room Fan"
    state_topic: "smartthings/Living Room Fan/switch"
    command_topic: "smartthings/Living Room Fan/switch"
    speed_state_topic: "smartthings/Living Room Fan/level"
    speed_command_topic: "smartthings/Living Room Fan/level"
    qos: 0
    payload_on: "on"
    payload_off: "off"
    payload_low_speed: "30"
    payload_medium_speed: "60"
    payload_high_speed: "90"
    speeds:
      - low
      - medium
      - high
  - platform: mqtt
    name: "Master Bedroom Fan"
    state_topic: "smartthings/Master Bedroom Fan/switch"
    command_topic: "smartthings/Master Bedroom Fan/switch"
    speed_state_topic: "smartthings/Master Bedroom Fan/level"
    speed_command_topic: "smartthings/Master Bedroom Fan/level"
    qos: 0
    payload_on: "on"
    payload_off: "off"
    payload_low_speed: "30"
    payload_medium_speed: "60"
    payload_high_speed: "90"
    speeds:
      - low
      - medium
      - high


###################
#                 #
# Groups          #
#                 #
###################
group:
  room_living:
    entities:
      - light.ge_living_room_1
      - light.ge_living_room_2
      - light.ge_living_room_3
  room_kitchen:
    entities:
      - light.kitchen_cabinet_lights
      - light.kitchen_island_lights
      - sensor.kitchen_multisensor_lux

  room_master_bathroom:
    entities:
      - light.master_bathroom_chandelier
      - light.master_bathroom_dimmer
      - light.master_bathroom_shower
      - switch.master_bathroom_fan

  room_guest_bathroom:
    entities:
      - light.guest_bathroom_lights
      - switch.guest_bathroom_fan

  outside_lights:
    entities:
      - light.entry_walkway_dimmer_switch
      - light.garage_outside_lights



###################
#                 #
# Light           #
#                 #
###################

light:
- platform: mqtt
  name: "ge_living_room_1"
  state_topic: "smartthings/GE Living Room 1/switch"
  command_topic: "smartthings/GE Living Room 1/switch"
  brightness_state_topic: "smartthings/GE Living Room 1/level"
  brightness_command_topic: "smartthings/GE Living Room 1/level"
  brightness_scale: 99
  brightness_value_template: '{{ value }}'
  qos: 1
  payload_on: "on"
  payload_off: "off"
  optimistic: false
  retain: true
- platform: mqtt
  name: "ge_living_room_2"
  state_topic: "smartthings/GE Living Room 2/switch"
  command_topic: "smartthings/GE Living Room 2/switch"
  brightness_state_topic: "smartthings/GE Living Room 2/level"
  brightness_command_topic: "smartthings/GE Living Room 2/level"
  brightness_scale: 99
  brightness_value_template: '{{ value }}'
  qos: 1
  payload_on: "on"
  payload_off: "off"
  optimistic: false
  retain: true
- platform: mqtt
  name: "ge_living_room_3"
  state_topic: "smartthings/GE Living Room 3/switch"
  command_topic: "smartthings/GE Living Room 3/switch"
  brightness_state_topic: "smartthings/GE Living Room 3/level"
  brightness_command_topic: "smartthings/GE Living Room 3/level"
  brightness_scale: 99
  brightness_value_template: '{{ value }}'
  qos: 1
  payload_on: "on"
  payload_off: "off"
  optimistic: false
  retain: true
- platform: mqtt
  name: "Guest Bathroom Lights"
  state_topic: "smartthings/Guest Bathroom Lights/switch"
  command_topic: "smartthings/Guest Bathroom Lights/switch"
  brightness_state_topic: "smartthings/Guest Bathroom Lights/level"
  brightness_command_topic: "smartthings/Guest Bathroom Lights/level"
  brightness_scale: 99
  brightness_value_template: '{{ value }}'
  qos: 1
  payload_on: "on"
  payload_off: "off"
  optimistic: false
  retain: true
- platform: mqtt
  name: "Entry_Walkway_Dimmer_Switch"
  state_topic: "smartthings/Entry Walkway Dimmer Switch/switch"
  command_topic: "smartthings/Entry Walkway Dimmer Switch/switch"
  brightness_state_topic: "smartthings/Entry Walkway Dimmer Switch/level"
  brightness_command_topic: "smartthings/Entry Walkway Dimmer Switch/level"
  brightness_scale: 99
  brightness_value_template: '{{ value }}'
  qos: 1
  payload_on: "on"
  payload_off: "off"
  optimistic: false
  retain: true
- platform: mqtt
  name: "Garage_Outside_Lights"
  state_topic: "smartthings/Garage Outside Lights/switch"
  command_topic: "smartthings/Garage Outside Lights/switch"
  brightness_state_topic: "smartthings/Garage Outside Lights/level"
  brightness_command_topic: "smartthings/Garage Outside Lights/level"
  brightness_scale: 99
  brightness_value_template: '{{ value }}'
  qos: 1
  payload_on: "on"
  payload_off: "off"
  optimistic: false
  retain: true
- platform: mqtt
  name: "Master_Bathroom_Dimmer"
  state_topic: "smartthings/Master bathroom dimmer/switch"
  command_topic: "smartthings/Master bathroom dimmer/switch"
  brightness_state_topic: "smartthings/Master bathroom dimmer/level"
  brightness_command_topic: "smartthings/master bathroom dimmer/level"
  brightness_scale: 99
  brightness_value_template: '{{ value }}'
  qos: 1
  payload_on: "on"
  payload_off: "off"
  optimistic: false
  retain: true
- platform: mqtt
  name: "Master_Bathroom_Shower"
  state_topic: "smartthings/Master bathroom shower/switch"
  command_topic: "smartthings/Master bathroom shower/switch"
  qos: 1
  payload_on: "on"
  payload_off: "off"
  optimistic: false
  retain: true
- platform: mqtt
  name: "Upstairs_Hall_Scone"
  state_topic: "smartthings/Upstairs Hall Scone/switch"
  command_topic: "smartthings/Upstairs Hall Scone/switch"
  brightness_state_topic: "smartthings/Upstairs Hall Scone/level"
  brightness_command_topic: "smartthings/Upstairs Hall Scone/level"
  brightness_scale: 99
  brightness_value_template: '{{ value }}'
  qos: 1
  payload_on: "on"
  payload_off: "off"
  optimistic: false
  retain: true
- platform: mqtt
  name: "Kitchen_Cabinet_Lights"
  state_topic: "smartthings/Kitchen Cabinet Lights/switch"
  command_topic: "smartthings/Kitchen Cabinet Lights/switch"
  payload_on: "on"
  payload_off: "off"
  optimistic: false
  retain: true
- platform: mqtt
  name: "Kitchen_island_Lights"
  state_topic: "smartthings/Kitchen Island Lights/switch"
  command_topic: "smartthings/Kitchen Island Lights/switch"
  brightness_state_topic: "smartthings/Kitchen Island Lights/level"
  brightness_command_topic: "smartthings/Kitchen Island Lights/level"
  brightness_scale: 99
  brightness_value_template: '{{ value }}'
  qos: 1
  payload_on: "on"
  payload_off: "off"
  optimistic: false
  retain: true
- platform: mqtt
  name: "Master_bathroom_chandelier"
  state_topic: "smartthings/Master bathroom chandelier/switch"
  command_topic: "smartthings/Master bathroom chandelier/switch"
  brightness_state_topic: "smartthings/Master bathroom chandelier/level"
  brightness_command_topic: "smartthings/Master bathroom chandelier/level"
  brightness_scale: 99
  brightness_value_template: '{{ value }}'
  qos: 1
  payload_on: "on"
  payload_off: "off"
  optimistic: false
  retain: true


###################
#                 #
# Sensor          #
#                 #
###################

sensor:
- platform: darksky
  api_key: !secret dark_sky_api
  scan_interval: 240
  monitored_conditions:
    - temperature
    - cloud_cover
    - wind_speed
    - wind_bearing

- platform: mqtt
  state_topic: "esp8266/garageIO/switch3"
  name: "garage service door"

- platform: mqtt
  state_topic: "esp8266/garageIO/temperature"
  name: "living_room_av_temperature"
  unit_of_measurement: "°F"
  value_template: '{{ value_json | float }}'

- platform: mqtt
  state_topic: "esp8266/garageIO/humidity"
  name: 'living_room_av_humidity'
  unit_of_measurement: '%'
  value_template: '{{ value_json | float }}'

- platform: mqtt
  state_topic: "smartthings/Aeon Multisensor 6/illuminance"
  name: "living_room_lux"
  unit_of_measurement: "Lux"
  value_template: '{{ value_json | float }}'

- platform: mqtt
  state_topic: "smartthings/Aeon Multisensor 6/temperature"
  name: "living_room_temperature"
  unit_of_measurement: "°F"
  value_template: '{{ value_json | float }}'

- platform: mqtt
  state_topic: "smartthings/Aeon Multisensor 6/humidity"
  name: "living_room_humidity"
  unit_of_measurement: "%"
  value_template: '{{ value_json | float }}'

- platform: mqtt
  state_topic: "smartthings/Aeon Multisensor 6/illuminance"
  name: "living_room_lux"
  unit_of_measurement: "Lux"
  value_template: '{{ value_json | float }}'

- platform: mqtt
  state_topic: 'smartthings/MultiSensor 6 Kitchen/tamper'
  name: 'kitchen_multisensor_tamper'

- platform: mqtt
  state_topic: 'smartthings/MultiSensor 6 Kitchen/temperature'
  name: 'kitchen_multisensor_temperature'
  unit_of_measurement: "°F"
  value_template: '{{ value_json | float }}'

- platform: mqtt
  state_topic: 'smartthings/MultiSensor 6 Kitchen/motion'
  name: 'kitchen_multisensor_motion'

- platform: mqtt
  state_topic: 'smartthings/MultiSensor 6 Kitchen/humidity'
  name: 'kitchen_multisensor_humidity'
  unit_of_measurement: "%"
  value_template: '{{ value_json | float }}'

- platform: mqtt
  state_topic: 'smartthings/MultiSensor 6 Kitchen/illuminance'
  name: 'kitchen_multisensor_lux'
  unit_of_measurement: "Lux"
  value_template: '{{ value_json | float }}'

- platform: mqtt
  state_topic: 'smartthings/MultiSensor 6 Kitchen/battery'
  name: 'kitchen_multisensor_battery'
  unit_of_measurement: "%"
  value_template: '{{ value_json | float }}'


####################
#                  #
# Template Sensors #
#                  #
####################

- platform: template
  sensors:
    living_room_remote_activity:
      value_template: '{{ states.remote.living_room.attributes.current_activity }}'
      friendly_name: 'Living Room Remote Activity'
    living_room_denon_volume:
      friendly_name: 'Living Room Denon Volume'
      value_template: >-
        {%- if states.media_player.denon_avrx3000.attributes.volume_level -%}
          {{states.media_player.denon_avrx3000.attributes.volume_level | float / 100 }}
        {%- else -%}
          off
        {%- endif -%}  
    avg_lux:
      friendly_name: 'Avg Lux'
      value_template: >-
        {%- if as_timestamp(now()) - as_timestamp(states.sensor.kitchen_multisensor_lux.last_changed) < 5000 -%}
          {%- if (states.sensor.living_room_lux.state | int + 
                  states.sensor.kitchen_multisensor_lux.state | int  < 400 ) -%}
               {{(states.sensor.living_room_lux.state | int + states.sensor.kitchen_multisensor_lux.state | int) / 2 }}
          {%- else -%}
             200
          {%- endif -%}
        {%- else -%}
          {{states.sensor.living_room_lux.state | int }}
        {%- endif -%}
      unit_of_measurement: 'Lux'
    bedroom_fan_desired_mode:
      friendly_name: 'Bedroom Fan Desired Mode'
      value_template: >-
        {%- if is_state("input_select.automation_mode","Away")  -%}
          off
        {%- elif is_state("input_select.automation_mode","Sleeping") -%}
          {%- if states.climate.main_floor.attributes.current_temperature > 77 -%}
            high
          {%- elif states.climate.main_floor.attributes.current_temperature > 71 -%}
            medium
          {%- elif states.climate.main_floor.attributes.current_temperature > 68 -%}
            low
          {%- else -%}
            off
          {%- endif -%}
        {%- else -%}
          off
        {%- endif -%}
    living_room_fan_desired_mode:
      friendly_name: 'Living Room Fan Desired Mode'
      value_template: >-
        {%- if is_state("input_select.automation_mode","Away")  -%}
          off
        {%- elif is_state("input_select.automation_mode","Home") -%}
          {%- if states.climate.main_floor.attributes.current_temperature > 77 -%}
            high
          {%- elif states.climate.main_floor.attributes.current_temperature > 75 -%}
            medium
          {%- elif states.climate.main_floor.attributes.current_temperature > 73 -%}
            low
          {%- else -%}
            off
          {%- endif -%}
        {%- else -%}
          off
        {%- endif -%}
    climate_main_floor_away_mode:
      friendly_name: 'Climate Main Floor Away Mode'
      value_template: >-
        {{states.climate.main_floor.attributes.away_mode}}
    climate_basement_away_mode:
      friendly_name: 'Climate Basement Away Mode'
      value_template: >-
        {{states.climate.basement.attributes.away_mode}}

- platform: statistics
  name: avg_lux_stats
  entity_id: sensor.avg_lux
  max_age:
    minutes: 15

- platform: statistics
  name: living_room_lux_stats
  entity_id: sensor.living_room_lux
  max_age:
    minutes: 15

- platform: statistics
  name: dark_sky_cloud_coverage_stats
  entity_id: sensor.dark_sky_cloud_coverage 
  max_age:
    minutes: 60

- platform: systemmonitor
  resources:
    - type: memory_use_percent
    - type: swap_use_percent
    - type: load_1m
    - type: load_5m

- platform: plex
  host: 192.168.1.10
  token: !secret plex_token

###################
#                 #
# Switch          #
#                 #
###################

switch:
- platform: mqtt
  name: "Fireplace"
  state_topic: "esp8266/fireplace/switch1"
  command_topic: "esp8266/fireplace/switch1/set"
  qos: 0
  retain: false
  payload_on: "ON"
  payload_off: "OFF"

- platform: mqtt
  name: "Guest Bathroom Fan"
  state_topic: "smartthings/Guest Bathroom Fan/switch"
  command_topic: "smartthings/Guest Bathroom Fan/switch"
  qos: 0
  retain: true
  payload_on: "on"
  payload_off: "off"
  optimistic: false

- platform: mqtt
  name: "Master Bathroom Fan"
  state_topic: "smartthings/Master bathroom fan/switch"
  command_topic: "smartthings/Master bathroom fan/switch"
  qos: 0
  retain: true
  payload_on: "on"
  payload_off: "off"
  optimistic: false


###################
#                 #
# Input Boolean   #
#                 #
###################

input_boolean:
# Combined Sensor Precense
  device_tracker_phil_home:
    name: device_tracker_phil_home
    initial: on
  device_tracker_nikki_home:
    name: device_tracker_nikki_home
    initial: on
# Used for homekit integration
  set_mode_sleeping:
    name: set_mode_sleeping
    initial: off
  set_mode_home:
    name: set_mode_home
  set_mode_away:
    name: set_mode_away
# Automation lux ontrol switches
  lux_light_control:
    name: 'Lights Auto Control'
    initial: on
# Automation Overall control
  automation_control_on:
    name: 'Automation Master Control'
    initial: on
# Motion Test
  stairs_motion_test:
    name: 'Stairs Motion Test'
    initial: off 
# Fireplace Control switch
  fireplace_automation:
    name: 'Fireplace Automation'
    initial: off
# Homekit Presence
  phil_homekit_present:
    name: phil homekit
    initial: on
  nikki_homekit_present:
    name: nikki homekit
    initial: on
# Text Alerts enabled
  text_alerts:
    name: text_alerts
    initial: on


###################
#                 #
# Input Select    #
#                 #
###################

input_select:
  automation_mode:
    name: 'Automation Mode'
    options:
     - Home
     - Away
     - Sleeping
    initial: Home
    icon: mdi:panda
  # List must match harmony.config names for automation scripts
  living_room_remote:
    name: 'Living Room Remote'
    options:
     - 'Watch TV'
     - 'Apple TV'
     - 'Music - cable'
     - 'PowerOff'
     - 'Music - cable - deck'
     - 'Apple TV - Deck'
     - 'Watch Netflix'
     - 'Watch Blu-Ray'
     - 'Watch TV / No Stereo'
    initial: 'PowerOff'
    icon: mdi:monitor

      
###################
#                 #
# Input Number    #
#                 #
###################

input_number:
  denon_volume:
    name: Denon Volume
    initial: 30
    min: 0
    max: 50 
    step: 2 
  denon_deck_volume:
    name: Denon Deck Volume
    initial: 40
    min: 0
    max: 70 
    step: 2
  lux_setpoint:
    name: lux setpoint
    initial: 25
    min: 0
    max: 100
    step: 5
  fireplace_high_setpoint:
    name: fireplace high setpoint
    initial: 72
    min: 70
    max: 80
    step: 1

###################
#                 #
# Scene           #
#                 #
###################

scene:
  - name: sleeping
    entities:
      input_boolean.set_mode_sleeping: on
  - name: home
    entities:
      input_boolean.set_mode_home: on
  - name: away
    entities:
      input_boolean.set_mode_away: on

###################
#                 #
# Timer           #
#                 #
###################

timer:
  guest_bathroom_fan_timer1:
    duration: '00:10:00'
  guest_bathroom_fan_timer2:
    duration: '00:30:00'
  master_bathroom_fan_timer1:
    duration: '00:10:00'
  master_bathroom_fan_timer2:
    duration: '00:45:00'
  stairs:
    duration: '00:15:00'
 
    #group: !include groups.yaml

script: !include scripts.yaml

automation: !include automations.yaml

shell_command: !include shell_commands.yaml

